---
title: "Graph1"
output: html_document
---

## Before meeting 11/8
 
```{r}
library(tidyverse)
library(ggplot2)
library(readr)
data <- read_csv("Data Basics/data.csv")
#View(data)
```


```{r}
data %>%
  group_by(stateusps)%>%
  summarise(count=n())
```
# Part 1: Above or Below Nation Average?
This series of visuals analyzes how states measure up to national averages on various home-life variables, and how that can have effects on education levels. 

National averages: 
```{r}
#Single-headed 
A <-data %>% 
  drop_na(SE_SINGLE)
A %>%
  summarise(avg_single= mean(SE_SINGLE))


#Median HouseHold income
B<- data%>%
  drop_na(SE_MHE)
B %>%
  summarise(avg_income=mean(SE_MHE))
```

Graphs:
```{r}
#Most populated: c("CA", "TX","FL", "NY", "PA", "IL", "OH","GA","NC","MI", "DC")
#least: c("WY", "VT", "AL","ND", "SD","DE","RI","MT", "MA")

# A) Single Household 
diff_single<-  A %>%  #Adding a new column that contains the states's deviation in single from the national average
  group_by(stateusps)%>%
  summarise(SE_SING= mean(SE_SINGLE))%>%
  mutate(average1 = SE_SING - mean(SE_SING))%>%
  select(stateusps, SE_SING, average1)%>%
  filter(row_number() %% 2 == 0)


#Graph
ggplot(diff_single, aes(x = reorder(stateusps, average1 ), y = average1,
           fill = average1 >0))+
  geom_bar(stat = "identity")+
  coord_flip()+
  scale_fill_discrete(name = "", labels = c("Below Average", "Above Average"))+
  labs(
    title="Single-headed Households ",
    subtitle="25 out of 50 states, we can see how each one is above or below the national average, 35.9%",
    x = "State",
    y = "Percent Difference"
  )+
  theme_bw()

# B) Median Income
diff_income<-  B %>%  #Adding a new column that contains the states's deviation in single from the national average
  group_by(stateusps)%>%
  summarise(SE_MHE= mean(SE_MHE))%>%
  mutate(average = SE_MHE - mean(SE_MHE))%>%
  select(stateusps, SE_MHE, average)%>%
  filter(row_number() %% 2 == 0)
#Why is this filter above not working??

#Graph
ggplot(diff_income, aes(x = reorder(stateusps, average), y = average,
           fill = average >0))+
  geom_bar(stat = "identity")+
  coord_flip()+
  scale_fill_discrete(name = "", labels = c("Below Average", "Above Average"))+
  labs(
    title="Household income ",
    subtitle="25 out of 50 states, we can see how each one is above or below the national average, $61,08",
    x = "State",
    y = "Percent Difference"
  )+
  theme_bw()

```
These two graphs represent 25 random states and how it compares to the national avergae income.
I want to change



ggplot(hc_avg_pay) +
  geom_col(aes(x = reorder(conf, avg_total_pay) , y = avg_total_pay, fill = conf_type)) +

# Part 2: How one variable affects the other. 
Bar plot per state, on average AP course., 
color adds layer of Percentage adults ages 25 and over with a college degree or higher.
```{r}
data1<-data %>% 
  drop_na(ED_APENR, ED_ATTAIN)

#ED_APENR : Ratio of students enrolled in at least one AP course to the number of 11th and 12th graders.
#ED_ATTAIN: Percentage adults ages 25 and over with a college degree or higher.

data2 <- data1%>%
  group_by(stateusps)%>%
  summarise(avg_AP=mean(ED_APENR), ap_a=mean(ED_ATTAIN))%>%
  arrange(desc(avg_AP))%>%
  filter(stateusps== c("CA", "TX", "FL", "NY", "PA", "IL", "OH", "GA", "NC", "MI", "DC")) #to get every other, is there a simpler way?
data2 

ggplot(data2, aes(x=reorder(stateusps, avg_AP), y=avg_AP))+
  geom_col(aes(col= ap_a, fill=ap_a))+
  labs(title="Percent of Students in AP Courses",
           y="Percent", 
           x="State")+
  theme_bw()

#Want to rename states
```


# Histogram of HS grad rate overall
```{r}
head(data)
ggplot(data, aes(x=ED_HSGRAD))+
  geom_histogram(aes(y = ..density..), colour = "black", fill = "white", binwidth = 2)+
  labs(
    title="High School Graduation Rate",
    x="Graduation Rate",
    y="Frequency"
  )+
  geom_density(alpha = .2, fill="blue")+
  xlim(0, 100) + 
  theme_bw()
#Confused about frequency on y axis
```


# Histogram of HS grad rate with and w/o poverty rate. 
Here we plot the same graph as above, but without entries from og dataset that have a poverty rate >25%
You could also substitute poverty rate w SE_MHE (Median income of all households.) 
```{r}
head(data)

data_pov <- data%>%
  select(ED_HSGRAD, SE_POVRATE)%>%
  arrange((SE_POVRATE))%>%
  filter(SE_POVRATE<0.10)

data_pov
ggplot(data_pov, aes(x=ED_HSGRAD))+
  geom_histogram(aes(y = ..density..), colour = "black", fill = "white", binwidth = 2)+
  labs(
    title="High School Graduation Rate",
    subtitle = "Graduation rates where percent of kids living in poverty less than 10%",
    x="Graduation Rate",
    y="Frequency"
  )+
  geom_density(alpha = .2, fill="#FF6675")+
  xlim(0, 100) + 
  theme_bw()

```


```{r}
data%>%
  group_by(msaname15)%>%
  filter(year=='2015')%>%
  summarise(city_pop= sum(pop))%>%
  arrange((city_pop))%>%
  na.omit(msaname15)

#Big city -> top 8 (kids)
#small city ->bottom 50 
```


## Before meeting 11/13

plotted the 2 histograms on top of each other (hs grad rate x )
How do I do this?

```{r}
w <- ggplot(data_pov, aes(x=ED_HSGRAD))+
  geom_density(alpha = .2, fill="#FF6675")+
  xlim(0, 100) + 
  theme_bw() 

v <- ggplot(data, aes(x=ED_HSGRAD))+
  geom_density(alpha = .2, fill="blue")+
  xlim(0, 100) + 
  theme_bw()

w
v
```

```{r}
data_ap<-data %>% 
  drop_na(ED_APENR, ED_ATTAIN) #update data to get rid of NAs in both columns

data_3 <- data_ap %>%
  group_by(stateusps)%>%
  summarise(avg_AP=mean(ED_APENR), ap_a=mean(ED_ATTAIN))%>%
  arrange(desc(avg_AP))%>%
  filter(row_number() %% 2 == 0) #to get every other, is there a simpler way?
data_3  

ggplot(data2, aes(x=reorder(stateusps, avg_AP), y=avg_AP))+
  geom_col(aes(col= ap_a, fill=ap_a, name='o'))+
  labs(title="Percent of Students in AP Courses",
           y="Percent", 
           x="State")+
  theme_bw()

#Want to rename states
```

# Los Angeles + counties

Big County: Los Angeles-Long Beach-Anaheim, CA Metro Area	
Surrounding: 


Percentage 18-24 year-olds enrolled in college within 25-mile radius.

Histograms ?
```{r}

head(data)

only_LA <- data %>%
  group_by(msaname15)%>%
  summarise(count=n())

only_LA
```




## Before meeting 11/15

We decided to focus on top 4/5 cities and compare the findings w the corresponding suburbs
Below, we will compare Los Angeles: 


One way we could do:

Each member focuses on a few things/variables/relationships between each variables across all 4 states. So that there can be consistency. Can compare to suburbs as well. 

If we do 1 state each, the analysis won't have consistency.


And 1 person focus on national averages? (or not necessary? )


1. Does college degree matter?
2. Does poverty impact on young children's basic ability? what about high school students?
3. Does preschool and ECE really matters for young children's basic ability?
4. If a teacher does not have a lot of experience, would it give bad impact on student's  score/ability?
5. Is there a big difference between students' score depending on which race prevails in number?
6. students living in a big city has better score than students living in suburb?














